# Central Communication service overview
*   1 [Introduction](#Introduction)
*   2 [features](#features)
*   3 [Diagram](#Diagram)
*   4 [structure](#structure)
    *   4.1 [API](#API)
    *   4.2 [OOB Provider](#OOB-Provider)
    *   4.3 [Service](#Service)
*   5 [Autogenerated sources](#Autogenerated-sources)
*   6 [Configuration](#Configuration)
    *   6.1 [Postman API collection](#Postman-API-collection)

# Introduction

Today, In order for Backbase components like Identity and Actions to send messages via push, sms or email channels the projects need to develop their own implementations.

Each project has to create and deploy an implementation of the following specs -

**Identity**

Sends out messages for features like oob authentication, oob transaction signing , device enrollment) , based on the selected channel (Push, SMS, email)

*   [![](./central-communication-service-overview-0.png)Create a custom communications outbound integration service - identity](https://community.backbase.com/documentation/identity/latest/create_a_custom_communications_outbound_integration_service)
    

**Actions -**

Sends out SMS and email with the help of integration services-

*   [https://community.backbase.com/documentation/DBS/latest/how\_to\_add\_email\_adapter](https://community.backbase.com/documentation/DBS/latest/how_to_add_email_adapter)
    
*   [https://community.backbase.com/documentation/DBS/latest/how\_to\_add\_sms\_adapter](https://community.backbase.com/documentation/DBS/latest/how_to_add_sms_adapter)
    

Hence there is a need of a project accelerator that implements all the above 3 specifications for Identity and Actions to work end to end.

The Central Communication Service provides connectivity functionality that integrates with actions and identity service for out of band communication such as SMS and Push notifications. these features are refactored from their independent service implementations (sms-service, Push-notification-service).

# features

*   Orchestration of requests coming from Identity and Actions via their respective Api’s
    
*   Push Notification Service Integration for Identity to send push notifications for out of band authentication and out of band transaction signing
    
*   SMS integration
    
*   Example Integration for sending Emails using AWS SNS via actions
    
*   Example Integration for sending SMS using Twilio via Identity and actions
    
*   85% Exhaustive code coverage with unit tests.
    

> **Why is this not productised yet?**
> 
> Q: We understand that email and sms connectors vary per project, Why is push notification integration not productised yet? -
> 
> A: **It is in Beta!** - With the upcoming Message Delivery Service [![](./central-communication-service-overview-1.png)Overview - foundation\_services](https://community.backbase.com/documentation/foundation_services/latest/overview_message_delivery) It is in **beta** right now and available GA in the coming months.
> 
> **However** -
> 
> *   Identity is yet to adopt the message delivery service (Plan Q4).
>     
> *   Actions will be deprecated in favour of Engagement Orchestrator which has to be adopted in the projects before message delivery service can be used.
>     
> 
> Hence this accelerator will also act as a bridge for projects which won’t be immediately adopting either the Latest version of identity when released, or dropping actions in favor of engagement orchestrator.

# Diagram

![](./central-communication-service-overview-2.png)

# structure

![](./central-communication-service-overview-3.png)

## API

This package contains the main controllers that handle the calls to the service. all API endpoints are defined here.

![](./central-communication-service-overview-4.png)

## OOB Provider

Every implementation is contained within this package. all connection logic, mappers and utilites for each implementation are stored here.

![](./central-communication-service-overview-5.png)

## Service

this package is used by services that are expecting batch requests, to be channelled via the supported channels in actions service. not all OOBs implementations need to be integrated here.

![](./central-communication-service-overview-6.png)

# Autogenerated sources

in order for the IDE to resolve the correct object classes for the project the following command has to be executed in the system’s console:  
  

`mvn clean generate-sources`

this uses the backbase building blocks maven dependency to create the common objects for services that need to interact with the actions services.

![](./central-communication-service-overview-7.png)

# Configuration

Configuration of the service is done via enviroment parameters in the basic installation yaml file in the CSE-applications-live repository.

![](./central-communication-service-overview-8.png)

all configuration values have to be stored in kubernetes secrets and referenced in this file.

the current environment values for the comms service are as follows:  
  

`env: "spring.autoconfigure.exclude": "org.springframework.cloud.netflix.eureka.loadbalancer.LoadBalancerEurekaAutoConfiguration,org.springframework.cloud.function.context.config.ContextFunctionCatalogAutoConfiguration" twilio.accountSid: valueFrom: secretKeyRef: name: twilio-credential key: accountSid twilio.authToken: valueFrom: secretKeyRef: name: twilio-credential key: authToken twilio.fromNumber: valueFrom: secretKeyRef: name: twilio-credential key: fromNumber valueFrom: secretKeyRef: name: cse-ret-eu-central-1-email-sender-account key: username spring.mail.password: valueFrom: secretKeyRef: name: cse-ret-eu-central-1-email-sender-account key: password spring.mail.host: valueFrom: configMapKeyRef: name: email-env key: host spring.mail.port: valueFrom: configMapKeyRef: name: email-env key: port spring.mail.properties.mail.transport.protocol: valueFrom: configMapKeyRef: name: email-env key: protocol spring.mail.properties.mail.smtp.auth: valueFrom: configMapKeyRef: name: email-env key: smtpAuth spring.mail.properties.mail.smtp.starttls.enable: valueFrom: configMapKeyRef: name: email-env key: starttlsEnable backbase.mail.from-address: valueFrom: configMapKeyRef: name: email-env key: fromAddress backbase.mail.from-name: valueFrom: configMapKeyRef: name: email-env key: fromName`

## Postman API collection

In order to add the email and phone number metadata for interacting and testing the service, calls to the model bank environment are needed. the collections can be downloaded below  
  

<table data-number-column="false"><colgroup><col style="width: 679px;"></colgroup><tbody><tr><th rowspan="1" colspan="1" colorname="" class="ak-renderer-tableHeader-sortable-column__wrapper" data-colwidth="680" aria-sort="none"><div class="ak-renderer-tableHeader-sortable-column"><div class="MediaGroup"><div class="css-ihx369"><div data-testid="filmstrip-list-wrapper" class="css-1jzvx93"><ul class="css-1llfiv8" style="transform: translateX(0px); transition-property: none; transition-duration: 0s;"><li class="media-filmstrip-list-item css-cctmi9" data-testid="media-filmstrip-list-item"><div data-context-id="3241739219" data-type="file" data-node-type="media" data-id="26bb61db-086a-41d4-9872-394a1ffcb5eb" data-collection="contentId-3241739219" data-file-name="CSE Identity - Ret.postman_environment.json" data-file-size="3186" data-file-mime-type="application/json" data-alt=""><div id="newFileExperienceWrapper" class="new-file-experience-wrapper css-1suy7fr" data-testid="media-card-view"><div role="presentation"><div class="media-file-card-view css-1yn77bd" data-testid="media-file-card-view" data-test-status="loading"><div id="iconWrapper" class="css-1bd7aaa"><span class="css-wmh6dk" style="animation-delay: 0ms; width: 24px; height: 24px;"><svg height="24" width="24" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" class="css-lowrtd" style="animation-delay: 0ms;"><circle cx="8" cy="8" r="7" class="css-1qav847" style="stroke: var(--ds-icon-subtle, #42526E);"></circle></svg></span></div><div class="media-card-blanket css-zicjcr"></div></div></div></div></div></li><li class="media-filmstrip-list-item css-cctmi9" data-testid="media-filmstrip-list-item"><div data-context-id="3241739219" data-type="file" data-node-type="media" data-id="cf467623-3d1a-4f85-a8dd-83bf1856c162" data-collection="contentId-3241739219" data-file-name="Ingest Push Notification Template.postman_collection.json" data-file-size="9333" data-file-mime-type="application/json" data-alt=""><div id="newFileExperienceWrapper" class="new-file-experience-wrapper css-1suy7fr" data-testid="media-card-view"><div role="presentation"><div class="media-file-card-view css-1yn77bd" data-testid="media-file-card-view" data-test-status="loading"><div id="iconWrapper" class="css-1bd7aaa"><span class="css-wmh6dk" style="animation-delay: 0ms; width: 24px; height: 24px;"><svg height="24" width="24" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" class="css-lowrtd" style="animation-delay: 0ms;"><circle cx="8" cy="8" r="7" class="css-1qav847" style="stroke: var(--ds-icon-subtle, #42526E);"></circle></svg></span></div><div class="media-card-blanket css-zicjcr"></div></div></div></div></div></li></ul></div></div></div><p data-renderer-start-pos="5610">&nbsp;</p><figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order"><div role="presentation"><div class="ak-renderer-tableHeader-sorting-icon css-qrn7se" role="button" tabindex="0" aria-label="sort column" aria-disabled="false"><div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive css-37qivc"><div class="css-1h55k8m"></div></div></div></div></figure></div></th></tr></tbody></table>

<table data-number-column="false"><colgroup><col style="width: 679px;"></colgroup><tbody><tr><th rowspan="1" colspan="1" colorname="" class="ak-renderer-tableHeader-sortable-column__wrapper" data-colwidth="680" aria-sort="none"><div class="ak-renderer-tableHeader-sortable-column"><div class="MediaGroup"><div class="css-ihx369"><div data-testid="filmstrip-list-wrapper" class="css-1jzvx93"><ul class="css-1llfiv8" style="transform: translateX(0px); transition-property: none; transition-duration: 0s;"><li class="media-filmstrip-list-item css-cctmi9" data-testid="media-filmstrip-list-item"><div data-context-id="3241739219" data-type="file" data-node-type="media" data-id="26bb61db-086a-41d4-9872-394a1ffcb5eb" data-collection="contentId-3241739219" data-file-name="CSE Identity - Ret.postman_environment.json" data-file-size="3186" data-file-mime-type="application/json" data-alt=""><div id="newFileExperienceWrapper" class="new-file-experience-wrapper css-1suy7fr" data-testid="media-card-view"><div role="presentation"><div class="media-file-card-view css-1yn77bd" data-testid="media-file-card-view" data-test-status="complete" data-test-media-name="CSE Identity - Ret.postman_environment.json" data-test-progress="1"><div id="iconWrapper" class="css-4viauj"><div data-testid="media-card-file-type-icon" data-type="source-code" class="css-1mgeve7 edaccvb0"><span role="img" aria-label="source-code" class="css-1afrefi" style="--icon-primary-color: currentColor; --icon-secondary-color: var(--ds-surface, #FFFFFF);"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><path fill="#00B8D9" fill-rule="evenodd" d="M3 0h18a3 3 0 013 3v18a3 3 0 01-3 3H3a3 3 0 01-3-3V3a3 3 0 013-3zm5.017 12.265l-2.58-2.501L8.236 7.05a.999.999 0 10-1.392-1.436l-3.54 3.432a1 1 0 000 1.436l3.32 3.219a1 1 0 101.393-1.436zm6.638-8.21a1 1 0 00-1.271.62l-4.83 14.046a1 1 0 001.892.65l4.829-14.045a1 1 0 00-.62-1.271zm6.081 9.776l-3.32-3.219a.999.999 0 10-1.393 1.436l2.58 2.501-2.799 2.714a.999.999 0 101.392 1.436l3.54-3.432a1 1 0 000-1.436z"></path></svg></span></div></div><div class="media-card-blanket css-zicjcr"></div><div id="titleBoxWrapper" class="css-156neve"><div id="titleBoxHeader" class="css-t1n7x8"><span class="css-1892tm3 evjscy50">CSE Identity - Ret.postman_environme</span><span class="css-1wnbhvg evjscy51">nt.json</span></div><div id="titleBoxFooter" class="css-1mkmovi">13 Jul 2021, 05:25 PM</div></div></div></div></div></div></li><li class="media-filmstrip-list-item css-cctmi9" data-testid="media-filmstrip-list-item"><div data-context-id="3241739219" data-type="file" data-node-type="media" data-id="cf467623-3d1a-4f85-a8dd-83bf1856c162" data-collection="contentId-3241739219" data-file-name="Ingest Push Notification Template.postman_collection.json" data-file-size="9333" data-file-mime-type="application/json" data-alt=""><div id="newFileExperienceWrapper" class="new-file-experience-wrapper css-1suy7fr" data-testid="media-card-view"><div role="presentation"><div class="media-file-card-view css-1yn77bd" data-testid="media-file-card-view" data-test-status="complete" data-test-media-name="Ingest Push Notification Template.postman_collection.json" data-test-progress="1"><div id="iconWrapper" class="css-4viauj"><div data-testid="media-card-file-type-icon" data-type="source-code" class="css-1mgeve7 edaccvb0"><span role="img" aria-label="source-code" class="css-1afrefi" style="--icon-primary-color: currentColor; --icon-secondary-color: var(--ds-surface, #FFFFFF);"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><path fill="#00B8D9" fill-rule="evenodd" d="M3 0h18a3 3 0 013 3v18a3 3 0 01-3 3H3a3 3 0 01-3-3V3a3 3 0 013-3zm5.017 12.265l-2.58-2.501L8.236 7.05a.999.999 0 10-1.392-1.436l-3.54 3.432a1 1 0 000 1.436l3.32 3.219a1 1 0 101.393-1.436zm6.638-8.21a1 1 0 00-1.271.62l-4.83 14.046a1 1 0 001.892.65l4.829-14.045a1 1 0 00-.62-1.271zm6.081 9.776l-3.32-3.219a.999.999 0 10-1.393 1.436l2.58 2.501-2.799 2.714a.999.999 0 101.392 1.436l3.54-3.432a1 1 0 000-1.436z"></path></svg></span></div></div><div class="media-card-blanket css-zicjcr"></div><div id="titleBoxWrapper" class="css-156neve"><div id="titleBoxHeader" class="css-t1n7x8"><span class="css-1892tm3 evjscy50">Ingest Push Notification Template.postman_collecti</span><span class="css-1wnbhvg evjscy51">on.json</span></div><div id="titleBoxFooter" class="css-1mkmovi">13 Jul 2021, 05:25 PM</div></div></div></div></div></div></li></ul></div></div></div><p data-renderer-start-pos="5610">&nbsp;</p><figure class="ak-renderer-tableHeader-sorting-icon__wrapper ak-renderer-tableHeader-sorting-icon__no-order"><div role="presentation"><div class="ak-renderer-tableHeader-sorting-icon css-qrn7se" role="button" tabindex="0" aria-label="sort column" aria-disabled="false"><div class="sorting-icon-svg__no_order ak-renderer-tableHeader-sorting-icon-inactive css-37qivc"><div class="css-1h55k8m"></div></div></div></div></figure></div></th></tr></tbody></table>